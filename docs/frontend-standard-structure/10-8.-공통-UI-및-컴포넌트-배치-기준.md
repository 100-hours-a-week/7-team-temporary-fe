## 8. 공통 UI 및 컴포넌트 배치 기준

### 8.1 공통 UI 정의 기준

- **TailwindCSS + shadcn/ui** 기반으로 공통 UI를 구성한다.
- 디자인 토큰은 `shared/styles`에서 관리한다.
- shadcn 컴포넌트는 수정 없이 wrapper로 사용한다.
- 공통 UI는 빠른 조합과 일관성을 우선한다.
- 배치 위치
  - 공통 컴포넌트: `shared/ui/**`
  - shadcn wrapper: `shared/ui/shadcn/**`
  - 스타일 토큰/테마: `shared/styles/**`
  - 전역 스타일 로드: `app/globals.css` (정의는 `shared/styles`에서 관리)
- 포함 범위
  - 입력/버튼/모달/탭/토스트 등 재사용 가능한 기본 컴포넌트
  - 로딩/빈 상태/에러 UI 등 상태성 UI
- 설계 기준
  - 공통 UI는 데이터/비즈니스 로직을 포함하지 않는다.
  - `variant/size/state` 등 범용 props만 제공한다.
  - 접근성(aria, focus, disabled) 기본 동작을 보장한다.
- 확장 기준
  - 디자인 변형은 wrapper에서 `className` 조합으로 해결한다.
  - 도메인 문구/규칙이 들어가면 feature/widget로 이동한다.

#### 8.1.도메인 조건 전달 원칙

- 공통 UI 컴포넌트는 도메인 조건을 직접 판단하지 않는다.
- `isOwner`, `canEdit`, `isAuthorized`처럼 도메인 의미를 가진 props는 금지한다.
- 도메인 조건 판단은 feature/widget 레이어에서 완료하고, 공통 UI에는 판단 결과만 전달한다.
- 조건부 렌더링도 feature/widget 레이어에서 처리한다.
- 공통 UI는 전달받은 props로 시각적 상태와 사용자 상호작용만 담당한다.

금지 예시

```tsx
<PrimaryButton variant="ownerOnly" />
```

권장 예시

```tsx
<PrimaryButton
  disabled={!canEdit}
  onClick={onEdit}
/>
```

설계 목적

- 공통 UI의 재사용성과 역할 범위를 명확히 유지한다.
- 도메인 규칙이 공통 UI로 전파되는 것을 방지한다.
- props 확장을 통한 공통 컴포넌트의 복잡도 증가를 제한한다.

### 8.2 비즈니스 규칙 포함 UI 기준

- 도메인 특화 UI는 feature/widget 레이어로 이동한다.
- 도메인 특화 UI는 조건부 스타일링을 허용한다.
- Emotion은 정책 기반 UI에만 허용한다.
- 포함 예시
  - 인증/권한/상태에 따라 변화하는 UI
  - 서버 응답에 따른 문구/상태 전환
  - 도메인 규칙(예: 채팅방 참여 여부)에 따른 표시
- 분리 기준
  - 공통 UI에서 제공하는 컴포넌트를 조합해 도메인 레이아웃을 구성한다.
  - 공통 UI를 수정해야 하는 요구는 우선 wrapper 확장으로 해결한다.

### 8.3 디자인 시스템 운영 기준

- 관리 범위
  - 디자인 토큰: `shared/styles`에서 통합 관리한다.
  - 공통 컴포넌트: `shared/ui`에 배치한다.
  - shadcn 기반 컴포넌트: `shared/ui/shadcn`에서 wrapper로 유지한다.
- 상태/Variant 기준
  - `variant/size/state` 체계를 공통으로 유지한다.
  - 상태 표현은 `disabled/loading/error/success` 기준으로 통일한다.
- 접근성 기준
  - 모든 입력/버튼은 `aria` 속성과 focus 스타일을 제공한다.
  - 키보드 내비게이션이 가능한지 Storybook에서 검증한다.
- 문서화 기준
  - 컴포넌트는 `*.stories.tsx`로 사용 예시를 남긴다.
  - 변경 사항은 Storybook에서 확인 가능한 스토리를 포함한다.

### 8.4 스타일링 우선순위

1. Tailwind utility (기본)
2. shadcn wrapper className 조합
3. Emotion (정책/상태 기반 UI에 한함)

#### 8.4.1 Emotion 사용 기준

- Emotion은 단순 상태 표현을 위한 스타일링에는 사용하지 않는다.
- 다음 조건을 만족하는 경우에만 Emotion 사용을 허용한다.
  - 스타일 결정에 여러 도메인 조건의 조합이 필요하다.
  - 조건에 따라 레이아웃 구조 또는 강조 규칙이 변경된다.
  - Tailwind className 조합으로 표현할 경우 가독성이 크게 저하된다.
  - 해당 스타일 규칙이 도메인 정책으로 반복 사용된다.
- Emotion은 feature/widget 레이어에서만 사용한다.
- 공통 UI(`shared/ui`)에서는 Emotion 사용을 금지한다.

허용 예시 (정책 기반 UI)

```tsx
const Card = styled.div<{ isUrgent: boolean; isPast: boolean }>`
  border-color: ${({ isUrgent, isPast }) => (isPast ? gray : isUrgent ? red : blue)};
`;
```

금지 예시 (단순 상태)

```tsx
<button className="hover:bg-blue-500 disabled:opacity-50" />
```

---
